
   import requests
from telegram.ext import Updater, CommandHandler, MessageHandler, Filters

# ØªÙˆÙƒÙ† Ø§Ù„Ø¨ÙˆØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† BotFather
TOKEN = "Ø¶Ø¹_Ø§Ù„ØªÙˆÙƒÙ†_Ù‡Ù†Ø§"

# Ø±Ø§Ø¨Ø· NHTSA API Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©
API_URL = "https://vpic.nhtsa.dot.gov/api/vehicles/DecodeVinValuesBatch/"

# Ø¯Ø§Ù„Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ
def check_vin(update, context):
    vin = update.message.text.strip()  # Ù‚Ø±Ø§Ø¡Ø© Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    if len(vin) != 17:  # Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø´Ø§ØµÙŠ Ù…ÙƒÙˆÙ† Ù…Ù† 17 Ø±Ù…Ø²Ù‹Ø§
        update.message.reply_text("âŒ Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ ØºÙŠØ± ØµØ­ÙŠØ­. ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ù…ÙƒÙˆÙ†Ù‹Ø§ Ù…Ù† 17 Ø±Ù…Ø²Ù‹Ø§.")
        return

    # Ø·Ù„Ø¨ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† API
    try:
        response = requests.post(API_URL, data={"format": "json", "data": vin})
        if response.status_code == 200:
            result = response.json()["Results"][0]
            # ØµÙŠØ§ØºØ© Ø§Ù„Ø±Ø¯
            reply = f"""
ğŸš— **ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©:**
- Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ù…ØµÙ†Ø¹Ø©: {result.get("Manufacturer", "ØºÙŠØ± Ù…ØªÙˆÙØ±")}
- Ø§Ù„Ø·Ø±Ø§Ø²: {result.get("Model", "ØºÙŠØ± Ù…ØªÙˆÙØ±")}
- Ø§Ù„Ø³Ù†Ø©: {result.get("ModelYear", "ØºÙŠØ± Ù…ØªÙˆÙØ±")}
- Ù†ÙˆØ¹ Ø§Ù„ÙˆÙ‚ÙˆØ¯: {result.get("FuelTypePrimary", "ØºÙŠØ± Ù…ØªÙˆÙØ±")}
            """
            update.message.reply_text(reply)
        else:
            update.message.reply_text("âŒ ØªØ¹Ø°Ø± Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ù„Ø§Ø­Ù‚Ù‹Ø§.")
    except Exception as e:
        update.message.reply_text("âš ï¸ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø¯Ù…Ø©. Ø­Ø§ÙˆÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§.")

# Ø¯Ø§Ù„Ø© Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª
def start(update, context):
    update.message.reply_text("Ù…Ø±Ø­Ø¨Ù‹Ø§! Ø£Ø±Ø³Ù„ Ù„ÙŠ Ø±Ù‚Ù… Ø§Ù„Ø´Ø§ØµÙŠ (VIN) Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø³ÙŠØ§Ø±Ø© ğŸš˜.")

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙˆØª
def main():
    updater = Updater(TOKEN, use_context=True)
    dp = updater.dispatcher

    # Ø£ÙˆØ§Ù…Ø± Ø§Ù„Ø¨ÙˆØª
    dp.add_handler(CommandHandler("start", start))
    dp.add_handler(MessageHandler(Filters.text & ~Filters.command, check_vin))

    # ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¨ÙˆØª
    updater.start_polling()
    updater.idle()

if __name__ == "__main__":
    main()
